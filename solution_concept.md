# Анализ данных и обзор концепции решения

Строим Online AntiFraud (ОАФ)

## Анализ полноты предоставленных данных:


"Из открытых источников известно, что у ближайших конкурентов"
Эта компания внедрила у себя антифрод или эта статистика по ситуации без ОАФ?
Есть ли данные до внедрения ОАФ?

"на каждую сотню проводимых их клиентами транзакций фиксируется не более двух мошеннических, приводящих к потере денежных средств."
Фиксируется - это реально происходит или обнаруживается ОАФ?
Сколько заявлений о мошенничестве пишется?

"При этом общий ущерб клиентов за месяц не превышает 500 тыс. руб."
1. Для какого количества клиентов в месяц? 
2. Что есть "ущерб"? Это потери клиентов или компании?

"Разрабатываемая система должна выдавать результаты не хуже"
Не хуже чего? ОАФ конкуретнов или у нас аномальная активность фродеров из-за какой-то особенности бизнеса и мы пытаемся
её снизить до уровня "обычных" компаний? Никто не может исключать APT именно в наш адрес.

"иначе компания станет неконкурентоспособной." 
Фраза непонятна, т.к. конкурентоспособность - способность определённого объекта или субъекта превзойти конкурентов в заданных условиях. 
Если у нас другие условия, то скорее имеет смысл выяснять причины таргетированной атаки, а не внедрять ОАФ.

"3. В среднем, компания обрабатывает около 50 транзакций в секунду, однако, перед праздниками это число может достигать 400."

1. Каков средний размер платежа в рамках одной транзакции?
2. Меняется ли эта величина в высокий сезон?
3. Какое максимально приемлемое время отклика ОАФ?
4. Что делать если мы не успеваем ответить за это время?
5. Есть ли специфика у разных транзакций, который потенциально могут влиять на время проверки?


"Если система определит корректную транзакцию как мошенническую, эта транзакция будет отклонена, а пользователь будет недоволен."

Мы всегда должны отклонять или отправлять в очередь ручной проверки?

"Опыт бизнес-аналитиков подсказывает, что если доля таких транзакций превысит 5 %, то начнется отток клиентов из компании"

Таких - это каких? Отклонённых или с ручной проверкой?
Что есть "начнётся отток"?
Какой уровень оттока приемлем для компании?

"Представители компании не готовы размещать разрабатываемый модуль на собственных вычислительных ресурсах.
6. При проведении транзакции системой вся информация о ней сохраняется в виде csv-файлов, каждая строка которых соответствует одной
транзакции. Информация о транзакциях некоторого фиксированного периода помещается в отдельный файл.
7. Файлы с данными содержат всю информацию о транзакциях, включая данные клиента, который ее проводил. Данная информация является
конфиденциальной, ее утечка недопустима."

Изумительное утверждение. Процессинговые данные это банковская тайна, т.е. стандарт ЦБ по ИБ. Если это связь с карточными процессингами,
то это в прошлой жизни требования PCI DSS и нет никаких реальных шансов разделить ОАФ и контур безопасности процессинга.
Стоимость выполнения требований в отдельной ОАФ буде внесколько раз дороже самой ОАФ.
Срокее всего в этих условиях проект вообще не имеет смысла, особенно из утверждения про 10 мл. руб.
Мы банально не имеем права использовать эти данные в системе, которая не прошла аттестацию по требованиям регуляторов.


Вывод:

Предоставленные данные недостаточны для проектирования системы ОАФ

Попробуем их дополнить:
1. Подозрительные транзакции не отклоняются полностью, а встают в очередь на ручную проверку.
2. Максимальное время ответа ОАФ на запрос о легальности операции - не более 3 секунд.
3. Никаких особенностей предоставляемых банковских услуг у Заказчика нет и рост фрода происходит на всём
рынке и не связан с нюансами технической реализации данных сервисов в ИТ-инфраструктуре.
5. Максимально приемлемый отток не более 1% текущих клиентов
6. Заказчик осознаёт риски обработки банковской и платёжной информации вне контура безопасности
и готов частично предоставить свои локальные мощности.

В этих условиях можно сформулировать следующие цели ОАФ
1. Сокращение уровня потерь Компании от наблюдаемых на момент постановки задачи сценариев фрода при выполнении банковских переводов
до уровня 500 т.руб в месяц при максимально приемлемом сокращении клиентской базы на 1% за бюджет в 10 млн. руб и в условии минимального предоставления 
вычислительных ресурсов Заказчиком.

2. Особенностью данных ОАФ является очень высокий уровень несбалансированности выборки по классам.
Наличие в "букете" принципиально разных сценариев фрода с общими участками, особенно с разным размером ущерба по ним, требует применения метрики устойчивой к подобной ситуации,но позволяющей производить дополнительную настройку под требования бизнеса по полноте и точности.
RP-AUC достаточно хорошо подходит под эти требования.

3. Специфика задачи сформулирована выше.

4. Основные подсистемы:
На территории Заказчика.
- ETL
- Потоковый блок реального времени (работает в составе системы Заказчика, обрабатывает поток реальных данных применяя модель ML и выдавая три варианта ответа: фрод, чисто, карантин)
- Система анонимизации потоковых данных (работает в составе системы Заказчика и формирует данные для передачи во вне контура безопасности)
- Локальные АРМ расследования фрода
- Озеро данных под сырые данные о фроде.
- Карантин и система АРМ я ручной обработки подозрительных операций.

Облачная среда
- Озеро анонимизированных данных
- Фичестор + Репозиторий экспериментов 
- Подсистема генерации синтетических данных
- Вычислительная среда
- Система нагрузочного тестирования
- Git репозитории кода моделей
- Репозиторий готовых моделей для загрузки в пром среду в контуре безопасности у Заказчика

5. Задачи:
- Провести анализ способов интеграции ИС Заказчика с внешними системами в части имеющихся интерфейсов и требуемых средств защиты
как в части извлечения данных из ИС Заказчика, так и передачи моделей в ИС Заказчика. Ожибаемый результат функциональная схема интеграции и обзор о предлагаемого решения. Срок 10 дней.
- Разработать и испытать модуль анонимизации данных под требования 161-ФЗ, 115-ФЗ и 152-ФЗ. Прототип должен бырь разработан на языке Python, Тестирование должно включать проверку качества анонимизации и сохранение статистических характеристик выборки после анонимизации. В качестве первоначальных данных искользовать выгрузку из ИС Заказчика. Разработку и тестирование осуществлять в защищённём контуре без доступа в Интернет. Срок 14 дней. Успешным результатом является подтверждение о сохранении статистических свойств, выполнение требований ФЗ по анонимизации и подтверждение возможности масштабирования под требуемый Заказчику поток данных.
- Провести предварительное исследование размеченных данных со сценариями фрода с целью выяснения сбалансированности выборки, состава и представительства различных сценариев, робастности выбранной метрики оценки качества моделей. Результат - отчёт. Срок 7 дней.
- Оценить потребности в вычислительных ресурсах для создания ОАФ
- Выбрать в рамках предполагаемой архитектуры оптимальный состав компонент на базе продуктов с открытым исходным кодом
- Развернуть прототипы локальной и облачных частей
- Предоставить доступ специалистам DS для разработки прототипов моделей ОАФ
